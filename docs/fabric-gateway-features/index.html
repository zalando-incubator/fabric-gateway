


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.0">
    
    
      
        <title>Features - Fabric Gateway</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.b5d04df8.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
    
    
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#fabric-gateway" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="Fabric Gateway" class="md-header-nav__button md-logo" aria-label="Fabric Gateway">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Fabric Gateway
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Features
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/zalando-incubator/fabric-gateway/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Fabric Gateway" class="md-nav__button md-logo" aria-label="Fabric Gateway">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Fabric Gateway
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/zalando-incubator/fabric-gateway/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1" checked>
    
    <label class="md-nav__link" for="nav-1">
      Fabric Gateway
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Fabric Gateway" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Fabric Gateway
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fabric-gateway-getting-started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Features
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="./" title="Features" class="md-nav__link md-nav__link--active">
      Features
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    Configuration
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dynamic-mode-externally-managed-services-eg-stacksets" class="md-nav__link">
    Dynamic Mode - Externally Managed Services (eg StackSets)
  </a>
  
    <nav class="md-nav" aria-label="Dynamic Mode - Externally Managed Services (eg StackSets)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#versioned-hosts" class="md-nav__link">
    Versioned Hosts
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple-mode-static-service" class="md-nav__link">
    Simple Mode - Static Service
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gateway-features" class="md-nav__link">
    Gateway Features
  </a>
  
    <nav class="md-nav" aria-label="Gateway Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#authentication" class="md-nav__link">
    Authentication
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authorization" class="md-nav__link">
    Authorization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#admin-access" class="md-nav__link">
    Admin Access
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rate-limiting" class="md-nav__link">
    Rate Limiting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encryption-in-transit" class="md-nav__link">
    Encryption In Transit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-hosts" class="md-nav__link">
    Multiple Hosts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-whitelisting" class="md-nav__link">
    Service Whitelisting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#employee-whitelisting" class="md-nav__link">
    Employee Whitelisting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cors-support" class="md-nav__link">
    CORS Support
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#other" class="md-nav__link">
    Other
  </a>
  
    <nav class="md-nav" aria-label="Other">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#path-matching" class="md-nav__link">
    Path Matching
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    Configuration
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dynamic-mode-externally-managed-services-eg-stacksets" class="md-nav__link">
    Dynamic Mode - Externally Managed Services (eg StackSets)
  </a>
  
    <nav class="md-nav" aria-label="Dynamic Mode - Externally Managed Services (eg StackSets)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#versioned-hosts" class="md-nav__link">
    Versioned Hosts
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple-mode-static-service" class="md-nav__link">
    Simple Mode - Static Service
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gateway-features" class="md-nav__link">
    Gateway Features
  </a>
  
    <nav class="md-nav" aria-label="Gateway Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#authentication" class="md-nav__link">
    Authentication
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authorization" class="md-nav__link">
    Authorization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#admin-access" class="md-nav__link">
    Admin Access
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rate-limiting" class="md-nav__link">
    Rate Limiting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encryption-in-transit" class="md-nav__link">
    Encryption In Transit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-hosts" class="md-nav__link">
    Multiple Hosts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-whitelisting" class="md-nav__link">
    Service Whitelisting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#employee-whitelisting" class="md-nav__link">
    Employee Whitelisting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cors-support" class="md-nav__link">
    CORS Support
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#other" class="md-nav__link">
    Other
  </a>
  
    <nav class="md-nav" aria-label="Other">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#path-matching" class="md-nav__link">
    Path Matching
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/zalando-incubator/fabric-gateway/edit/master/docs/fabric-gateway-features.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="fabric-gateway">Fabric Gateway<a class="headerlink" href="#fabric-gateway" title="Permanent link">&para;</a></h1>
<p>Fabric Gateway is a Kubernetes control plane for <a href="https://github.com/zalando/skipper">Skipper</a>, the open-source HTTP router. It delivers a feature-rich API gateway that secures applications at the point of ingress to a Kubernetes cluster. It is a security-audited and scalable solution that makes it easy for developers to secure and monitor APIs at scale.</p>
<p><img alt="Gateway only" src="../img/gateway-only.png" /></p>
<h2 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permanent link">&para;</a></h2>
<p>Fabric Gateway is configured via a Kubernetes <a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/">Custom Resource Definition</a> (CRD) of kind <code>FabricGateway</code>. To enable for an application create the <code>FabricGateway</code> resource in your cluster.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">zalando.org/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">FabricGateway</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-app-gateway</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="c1"># Simple Mode with static Service</span>
  <span class="nt">x-fabric-service</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-app.smart-product-platform-test.zalan.do</span>
      <span class="nt">serviceName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-app-service-name</span>
      <span class="nt">servicePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">http</span>
  <span class="nt">x-fabric-admins</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">bmooney</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">fmoloney</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cgallagher</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">jblogs</span>
  <span class="nt">paths</span><span class="p">:</span>
    <span class="nt">/api/resource</span><span class="p">:</span>
      <span class="nt">post</span><span class="p">:</span>
        <span class="nt">x-fabric-privileges</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="s">&quot;spp-application.write&quot;</span>
        <span class="nt">x-fabric-ratelimits</span><span class="p">:</span>
          <span class="nt">default-rate</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>
          <span class="c1"># Valid values are &#39;hour&#39; and &#39;minute&#39;, defaults to &#39;minute&#39; if omitted.</span>
          <span class="nt">period</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">minute</span>
          <span class="nt">target</span><span class="p">:</span>
            <span class="nt">stups_spp_service_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">50</span>
    <span class="nt">/api/resource/*</span><span class="p">:</span>
      <span class="nt">get</span><span class="p">:</span>
        <span class="nt">x-fabric-privileges</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="s">&quot;spp-application.read&quot;</span>
      <span class="nt">put</span><span class="p">:</span>
        <span class="nt">x-fabric-privileges</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="s">&quot;spp-application.write&quot;</span>
        <span class="nt">x-fabric-ratelimits</span><span class="p">:</span>
          <span class="nt">default-rate</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>
      <span class="nt">patch</span><span class="p">:</span>
        <span class="nt">x-fabric-privileges</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="s">&quot;spp-application.write&quot;</span>
        <span class="nt">x-fabric-ratelimits</span><span class="p">:</span>
          <span class="nt">default-rate</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>
    <span class="nt">/events</span><span class="p">:</span>
      <span class="nt">post</span><span class="p">:</span>
        <span class="nt">x-fabric-privileges</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="s">&quot;spp-application.read&quot;</span>
</code></pre></div>

<p>Gateway can be configured to work in Dynamic Mode with an external <a href="https://kubernetes.io/docs/concepts/services-networking/service/">Kubernetes service</a> provider such as <a href="https://github.com/zalando-incubator/stackset-controller">StackSets</a>, or in Simple Mode with a static service defined. See Dynamic Mode and Simple Mode sub-sections below.</p>
<p><strong>N.B.</strong> If using <code>FabricGateway</code> to manage auth for your service, remove any existing ingress resources for your service. You should not have both as an existing ingress could allow unauthenticated traffic to your backend service.</p>
<h3 id="dynamic-mode-externally-managed-services-eg-stacksets">Dynamic Mode - Externally Managed Services (eg StackSets)<a class="headerlink" href="#dynamic-mode-externally-managed-services-eg-stacksets" title="Permanent link">&para;</a></h3>
<p>In Dynamic Mode Fabric Gateway will work with an external operator that manages the creation of <a href="https://kubernetes.io/docs/concepts/services-networking/service/">Kubernetes services</a>. This is enabled by setting the <code>x-external-service-provider</code> key as per the below example.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">zalando.org/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">FabricGateway</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">stackset-managed-test</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">x-external-service-provider</span><span class="p">:</span>
    <span class="nt">hosts</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">stackset-managed-test.cluster.zalan.do</span>
    <span class="nt">stackSetName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;name-of-stackset-k8s-resource&gt;</span>
  <span class="nt">paths</span><span class="p">:</span>
    <span class="nt">/resources</span><span class="p">:</span>
      <span class="nt">get</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
</code></pre></div>

<p>In the above example, we are not defining any services (and it is illegal to define services via the <code>x-fabric-service</code> key if you have the <code>x-external-service-provider</code> set) in the Gateway resource. Instead, we are saying that these services will be provided by a <a href="https://cloud.docs.zalando.net/tutorials/migrating-from-stups/#recommended-stacksets">StackSet</a> operator. The created gateway will not generate any ingress resources until the named StackSet is present and has service details available.</p>
<h4 id="versioned-hosts">Versioned Hosts<a class="headerlink" href="#versioned-hosts" title="Permanent link">&para;</a></h4>
<p>When using the stackset integration, the gateway will also configure a host for accessing each stack individually, ignoring traffic-switching. For example, if you have stacks <code>my-stack-v1</code> and <code>my-stack-v2</code> and the gateway operator has set <code>VERSIONED_HOSTS_BASE_DOMAIN</code> to <code>cluster.zalan.do</code>, you will be able to access the stacks at <code>https://my-stack-v1.cluster.zalan.do</code> and <code>https://my-stack-v2.cluster.zalan.do</code> respectively.</p>
<p>For these hosts:</p>
<ul>
<li>All authorization, cors and other configured rules will still apply.</li>
<li>Rate-limiting is done by path and shared between hosts. This means you can use up the rate-limit by using any combination of versioned hosts and the main traffic-switched host. In the above example, hitting <code>https://my-stack-v1.cluster.zalan.do/api</code>, then <code>https://my-stack-v2.cluster.zalan.do/api</code>, then <code>https://my-stack.cluster.zalan.do/api</code> counts as 3 towards your rate-limit for the <code>/api</code> path.</li>
</ul>
<h3 id="simple-mode-static-service">Simple Mode - Static Service<a class="headerlink" href="#simple-mode-static-service" title="Permanent link">&para;</a></h3>
<p>In Simple Mode an existing Kubernetes service is declared in the <code>FabricGateway</code> resource. This is done by setting the <code>x-fabric-service</code> key as per the below example.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">zalando.org/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">FabricGateway</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">stackset-managed-test</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">x-fabric-service</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-app.smart-product-platform-test.zalan.do</span>
      <span class="nt">serviceName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-app-service-name</span>
      <span class="nt">servicePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">http</span>
  <span class="nt">paths</span><span class="p">:</span>
    <span class="nt">/resources</span><span class="p">:</span>
      <span class="nt">get</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
</code></pre></div>

<p>For <code>servicePort</code>, you <strong>must</strong> specify a <strong>named</strong> port from your service definition. If you don&rsquo;t specify <code>servicePort</code>, Fabric Gateway defaults to a port named &lsquo;http&rsquo;.<br />
Below is an example of a service with a named port:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">labels</span><span class="p">:</span>
    <span class="nt">application</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">APPLICATION</span><span class="nv"> </span><span class="s">}}&quot;</span>
    <span class="nt">version</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">VERSION</span><span class="nv"> </span><span class="s">}}&quot;</span>
  <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">APPLICATION</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">selector</span><span class="p">:</span>
    <span class="nt">application</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">APPLICATION</span><span class="nv"> </span><span class="s">}}&quot;</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ClusterIP</span>
  <span class="nt">ports</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">http</span>
      <span class="nt">port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
      <span class="nt">targetPort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8080</span>
</code></pre></div>

<h2 id="gateway-features">Gateway Features<a class="headerlink" href="#gateway-features" title="Permanent link">&para;</a></h2>
<p>Fabric Gateway provides the following features.</p>
<ul>
<li>Authentication</li>
<li><a href="#authorization">Authorization</a></li>
<li>Admin Access</li>
<li>Service Whitelisting</li>
<li>Employee Whitelisting</li>
<li>Encryption In Transit</li>
<li>Rate Limiting</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">Cross-Origin Resource Sharing</a></li>
</ul>
<h3 id="authentication">Authentication<a class="headerlink" href="#authentication" title="Permanent link">&para;</a></h3>
<p>Fabric Gateway can be used in place of internal logic for authenticating access from other services using the
Zalando IAM service. As we only accept <code>service</code> and <code>employee</code> tokens, the gateway is not a candidate for customer
auth workflows. There will be a header added to the request, <code>X-TokenInfo-Forward</code>. 
This will contain the <code>uid</code>, <code>scope</code> and <code>realm</code> retrieved from from the <a href="https://cloud.docs.zalando.net/howtos/authenticate-requests/#oauth2-endpoints">Token Info endpoint</a>.</p>
<h3 id="authorization">Authorization<a class="headerlink" href="#authorization" title="Permanent link">&para;</a></h3>
<p>To confirm that each authenticated token is from a valid service or employee, the gateway will implicitly add a scope
check for the <code>uid</code> scope. It is possible to add further scope restrictions to an endpoint by adding the scope name to
the <code>x-fabric-privileges</code> key. For example if you have a privilege section for an endpoint defined as per below, then 
the token will need the implicit <code>uid</code> scope as well as <strong>both</strong> of the defined <code>events.write</code> and <code>service.write</code> scopes before
it will be allowed to access the endpoint.</p>
<div class="highlight"><pre><span></span><code><span class="nn">...</span>
    <span class="nt">/events</span><span class="p">:</span>
      <span class="nt">post</span><span class="p">:</span>
        <span class="nt">x-fabric-privileges</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="s">&quot;events.write&quot;</span>
          <span class="p p-Indicator">-</span> <span class="s">&quot;service.write&quot;</span>
</code></pre></div>

<h3 id="admin-access">Admin Access<a class="headerlink" href="#admin-access" title="Permanent link">&para;</a></h3>
<p>Team members can be added to your <code>x-fabric-admins</code> list. The uids in this list will have access to all endpoints and will not be subject to rate-limiting or other authentication rules.</p>
<h3 id="rate-limiting">Rate Limiting<a class="headerlink" href="#rate-limiting" title="Permanent link">&para;</a></h3>
<p>If a client of the gateway is getting rate limited, they will get a <code>429</code>
HTTP response code. There will also be some headers included to indicate
when they will be able to make requests again. Below is a sample rate limited
response from the gateway.<br />
The <code>Retry-After</code> header, shows the number of seconds before you may attempt a new request.
The informational <code>X-Rate-Limit</code> header always shows the number of requests per hour which 
the client is allowed to make, regardless of which <code>period</code> is used when configuring the rate-limit.</p>
<div class="highlight"><pre><span></span><code>curl -i -H <span class="s2">&quot;Authorization: Bearer </span><span class="nv">$FDA</span><span class="s2">&quot;</span> https://fgtestapp.smart-product-platform-test.zalan.do/limited/me

HTTP/2 <span class="m">429</span>
date: Tue, <span class="m">26</span> Mar <span class="m">2019</span> <span class="m">12</span>:05:51 GMT
content-type: text/plain<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>utf-8
content-length: <span class="m">18</span>
retry-after: <span class="m">53</span>
server: Skipper
x-content-type-options: nosniff
x-rate-limit: <span class="m">120</span>
</code></pre></div>

<p><strong>N.B.</strong>
If you want to apply a service specific rate-limit, then the service name must be prepended with
<code>stups_</code>. This can be seen in the <code>x-fabric-ratelimits.target</code> section of the main Configuration 
example above.</p>
<h3 id="encryption-in-transit">Encryption In Transit<a class="headerlink" href="#encryption-in-transit" title="Permanent link">&para;</a></h3>
<p>The gateway will ensure that no requests are hitting your service
unless they are encrypted using <code>https</code>. To achieve this, we have a skipper
filter on every route, which will reject the request with a 400 response if
it contains the <code>X-Forwarded-Proto: http</code> header. This is an extra layer of
security to ensure that people are not interacting with your service in
an insecure manner.</p>
<p>An example request can be seen below:</p>
<div class="highlight"><pre><span></span><code>curl -i -H <span class="s2">&quot;Authentication: Bearer </span><span class="k">$(</span>ztoken<span class="k">)</span><span class="s2">&quot;</span> http://fgtestapp.smart-product-platform-test.zalan.do/resources
HTTP/1.1 <span class="m">400</span> Forbidden
Date: Fri, <span class="m">01</span> Mar <span class="m">2019</span> <span class="m">10</span>:38:05 GMT
Content-Type: text/plain<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>utf-8
Content-Length: <span class="m">104</span>
Connection: keep-alive
Server: Skipper

<span class="o">{</span>
  <span class="s2">&quot;title&quot;</span>: <span class="s2">&quot;Gateway Rejected&quot;</span>,
  <span class="s2">&quot;status&quot;</span>: <span class="m">400</span>,
  <span class="s2">&quot;detail&quot;</span>: <span class="s2">&quot;TLS is required&quot;</span>,
  <span class="s2">&quot;type&quot;</span>: <span class="s2">&quot;https://cloud.docs.zalando.net/howtos/ingress/#redirect-http-to-https&quot;</span>
<span class="o">}</span>
</code></pre></div>

<h3 id="multiple-hosts">Multiple Hosts<a class="headerlink" href="#multiple-hosts" title="Permanent link">&para;</a></h3>
<p>All created Skipper routes will match incoming requests first by their host.<br />
If you have multiple hosts for a service, then each of these needs to be listed in the gateway resource.</p>
<h3 id="service-whitelisting">Service Whitelisting<a class="headerlink" href="#service-whitelisting" title="Permanent link">&para;</a></h3>
<p>You can define either a global or a route-level whitelist for your gateway as per the below examples.
What this means is that only services whose names are defined in the whitelist will be able
to interact with your service. All other access requirements, i.e. scopes
and rate limits, will still apply to the whitelisted service.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">zalando.org/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">FabricGateway</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-app-gateway</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">x-fabric-service</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-app.smart-product-platform-test.zalan.do</span>
      <span class="nt">serviceName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-app-service-name</span>
      <span class="nt">servicePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">http</span>
  <span class="nt">x-fabric-admins</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">jblogs</span>
  <span class="nt">x-fabric-whitelist</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">stups_some-whitelisted-service</span>
  <span class="nt">paths</span><span class="p">:</span>
    <span class="nt">/api/resource</span><span class="p">:</span>
      <span class="nt">get</span><span class="p">:</span>
        <span class="nt">x-fabric-privileges</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="s">&quot;spp-application.write&quot;</span>
      <span class="nt">post</span><span class="p">:</span>
        <span class="nt">x-fabric-privileges</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="s">&quot;spp-application.write&quot;</span>
        <span class="c1"># This is a more fine-grained whitelist and overrides the global whitelist. Only some-other-service can access this path.</span>
        <span class="c1"># This id is taken from the &quot;sub&quot; field of a JWT token. For a service, this value is always &quot;stups_&quot; followed by the application&#39;s Kio id.</span>
        <span class="c1"># some-whitelisted-service from the global whitelist cannot access this path.</span>
        <span class="nt">x-fabric-whitelist</span><span class="p">:</span>
          <span class="nt">service-list</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">stups_some-other-service</span>
      <span class="nt">head</span><span class="p">:</span>
        <span class="nt">x-fabric-privileges</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="s">&quot;spp-application.read&quot;</span>
        <span class="c1"># Another type of fine-grained whitelist over-ride is to disabled whitelisting altogether and allow any</span>
        <span class="c1"># service which has the correct scopes to access the route.</span>
        <span class="nt">x-fabric-whitelist</span><span class="p">:</span>
          <span class="nt">state</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">disabled</span>
          <span class="nt">service-list</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
    <span class="l l-Scalar l-Scalar-Plain">/api/resource/{resource_id}</span><span class="p p-Indicator">:</span>
      <span class="nt">put</span><span class="p">:</span>
        <span class="c1"># This whitelist config overrides the global whitelist and because of the empty whitelist</span>
        <span class="c1"># no other service will be able to access this route. i.e. Only defined admins would be able to access the</span>
        <span class="c1"># route</span>
        <span class="nt">x-fabric-whitelist</span><span class="p">:</span>
          <span class="nt">service-list</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
</code></pre></div>

<h3 id="employee-whitelisting">Employee Whitelisting<a class="headerlink" href="#employee-whitelisting" title="Permanent link">&para;</a></h3>
<p>Employee tokens do not use scopes, so in order to allow certain employees access to an endpoint we must whitelist their uid. Note that this is different to <a href="#admin-access">Admin Access</a> since admins are not subject to rate limits.<br />
In the example below, we can see that the <code>/api/resource</code> <code>get</code> endpoint can be accessed by services with the <code>spp-application.write</code> scope or the employee whose uid is <code>useruid</code>. The service and the employee will be subject to a ratelimit of 5 requests per minute.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">zalando.org/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">FabricGateway</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-app-gateway</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">x-fabric-service</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-app.smart-product-platform-test.zalan.do</span>
      <span class="nt">serviceName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-app-service-name</span>
      <span class="nt">servicePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">http</span>
  <span class="nt">paths</span><span class="p">:</span>
    <span class="nt">/api/resource</span><span class="p">:</span>
      <span class="nt">get</span><span class="p">:</span>
        <span class="nt">x-fabric-privileges</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="s">&quot;spp-application.write&quot;</span>
        <span class="nt">x-fabric-employee-access</span><span class="p">:</span>
          <span class="nt">user-list</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">useruid</span>
        <span class="nt">x-fabric-ratelimits</span><span class="p">:</span>
          <span class="nt">default-rate</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5</span>
</code></pre></div>

<h3 id="cors-support">CORS Support<a class="headerlink" href="#cors-support" title="Permanent link">&para;</a></h3>
<p>For browser applications to communicate directly with an API, the API needs to support <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">Cross-Origin Resource Sharing</a>. The Gateway supports this by automatically adding an OPTIONS endpoint to each of your paths to handle browser <a href="https://developer.mozilla.org/en-US/docs/Glossary/Preflight_request">Preflight Requests</a>. The origins and headers you configure will be allowed in the response headers. Additionally, configuring cors support causes the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin">Access-Control-Allow-Origin header</a> to contain the request&rsquo;s <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Origin">Origin</a> if you have whitelisted it here.  </p>
<p>Note: We do not allow <code>*</code> to be used as an allowed origin. Every Gateway API will want to allow the <code>Authorization</code> and <code>Content-Type</code> headers here, to allow auth tokens and the <code>application/json</code> <code>Content-Type</code> to be used.</p>
<p>In the example below, they gateway will generate an OPTIONS route for the <code>/api/resources</code> path. This will support preflighted requests for your listed HTTP verbs, <code>allowedOrigins</code> and <code>allowedHeaders</code>. Once the preflight is done, the actual request will also automatically have the right <code>Access-Control-Allow-Origin</code> header if the request Origin is allowed.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">zalando.org/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">FabricGateway</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-app-gateway</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">x-fabric-service</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-app.smart-product-platform-test.zalan.do</span>
      <span class="nt">serviceName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-app-service-name</span>
      <span class="nt">servicePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">http</span>
  <span class="nt">x-fabric-cors-support</span><span class="p">:</span>
    <span class="nt">allowedOrigins</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">example.com</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">example-other.com</span>
    <span class="nt">allowedHeaders</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Authorization</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Content-Type</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">X-Flow-Id</span>
  <span class="nt">paths</span><span class="p">:</span>
    <span class="nt">/api/resource</span><span class="p">:</span>
      <span class="nt">get</span><span class="p">:</span>
        <span class="nt">x-fabric-privileges</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="s">&quot;spp-application.write&quot;</span>
</code></pre></div>

<h2 id="other">Other<a class="headerlink" href="#other" title="Permanent link">&para;</a></h2>
<h3 id="path-matching">Path Matching<a class="headerlink" href="#path-matching" title="Permanent link">&para;</a></h3>
<p>There are some rules around path matching in the gateway which are outlined below.</p>
<ul>
<li>Dynamic path segments should be represented by either a <code>*</code> or a <code>{named}</code> parameter</li>
<li>Wildcard matching of multiple path segments can be performed by using <code>**</code>, the <code>**</code> must be the last part of the path</li>
</ul>
<p>Examples of some valid and invalid paths are outlined below:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">zalando.org/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">FabricGateway</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-app-gateway</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">x-fabric-service</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-app.smart-product-platform-test.zalan.do</span>
      <span class="nt">serviceName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-app-service-name</span>
      <span class="nt">servicePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">http</span>
  <span class="nt">x-fabric-admins</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">jblogs</span>
  <span class="nt">paths</span><span class="p">:</span>
    <span class="c1"># This is an exact path match. The only URI that will be matched is a GET request against `/api/resource`</span>
    <span class="nt">/api/resource</span><span class="p">:</span>
      <span class="nt">get</span><span class="p">:</span>
        <span class="nt">x-fabric-privileges</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="s">&quot;spp-application.read&quot;</span>
    <span class="c1"># Match a path which has a dynamic segment. This will match any identifer for the resource</span>
    <span class="c1"># e.g. /api/resource/123 /api/resource/abc-123 etc...</span>
    <span class="c1"># However this will only match a single path segment so the below would not be matched</span>
    <span class="c1"># /api/resource/123/sub-resource</span>
    <span class="nt">/api/resource/*</span><span class="p">:</span>
          <span class="nt">get</span><span class="p">:</span>
            <span class="nt">x-fabric-privileges</span><span class="p">:</span>
              <span class="p p-Indicator">-</span> <span class="s">&quot;spp-application.read&quot;</span>
    <span class="c1"># This is the exact same as the above dynamic segment matching, except that the segment is named.</span>
    <span class="c1"># The name of the segment currently has no extra significance</span>
    <span class="l l-Scalar l-Scalar-Plain">/api/resource/{resource_id}</span><span class="p p-Indicator">:</span>
          <span class="nt">get</span><span class="p">:</span>
            <span class="nt">x-fabric-privileges</span><span class="p">:</span>
              <span class="p p-Indicator">-</span> <span class="s">&quot;spp-application.read&quot;</span>
    <span class="c1"># The double * is a wildcard match. This wildcard will match across multiple segments in the URI</span>
    <span class="c1"># For example the following paths would be successfully matched:</span>
    <span class="c1"># e.g. /api/someresource/123 /api/someresource/123/sub-resource /api/someresource/123/sub-resource/123</span>
    <span class="nt">/api/someresource/**</span><span class="p">:</span>
      <span class="nt">get</span><span class="p">:</span>
        <span class="nt">x-fabric-privileges</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="s">&quot;spp-application.read&quot;</span>
    <span class="c1"># There is a requirement for ** to be at the end of the path. The below path key would be considered</span>
    <span class="c1"># invalid</span>
    <span class="nt">/api/someresource/**/subkey</span><span class="p">:</span>
      <span class="nt">get</span><span class="p">:</span>
        <span class="nt">x-fabric-privileges</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="s">&quot;spp-application.read&quot;</span>  
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../fabric-gateway-getting-started/" title="Getting Started" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Getting Started
              </div>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.92ffa368.min.js"></script>
      <script src="../assets/javascripts/bundle.5123e3d4.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.a68abb33.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>